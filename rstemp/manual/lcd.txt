===== LCD HY-1602F6 (zgodny z Hitachi HD44780) =====

==== Podłączenie ====

Podłączyć wg schematu:

^ LCD 		^^^ BeagleBone Black ^^
^ Pin no	^ Symbol	^ Description							^ Pin no	^ Symbol			^
| 1		| VSS		| GND								|		| GND				|
| 2		| VDD		| Power supply for logic (+ 5.0)				| P9_7		| SYS_5V			|
| 3		| Vo		| Power supply for LCD (Contrast adjustment)			|		| SYS_5V + 10k potentiometer	|
| 4		| RS		| Register selection (H:Data registor, L:Instruction registor)	| P8_8		| GPIO_67			|
| 5		| R/W		| Read/write selection (H:Read, L:Write)			|		| GND				|
| 6		| E		| Enable signal for chip					| P8_10		| GPIO_68			|
| 7		| DB0		| Data bus line							| ---		| ---				|
| 8		| DB1		| Data bus line							| ---		| ---				|
| 9		| DB2		| Data bus line							| ---		| ---				|
| 10		| DB3		| Data bus line							| ---		| ---				|
| 11		| DB4		| Data bus line							| P8_18		| GPIO_65			|
| 12		| DB5		| Data bus line							| P8_16		| GPIO_46			|
| 13		| DB6		| Data bus line							| P8_14		| GPIO_26			|
| 14		| DB7		| Data bus line							| P8_12		| GPIO_44			|
| 15		| LEDA		| Power supply for backlight (+)				|		| SYS_5V			|
| 16		| LEDK		| Power supply for backlight (-)				|		| GND				|

==== Moduł dla Linuxa ====

Pobrać i wykonać analogicznie do [[beagleboneblack:openwrt:kompilacja_wlasnego_pakietu|Kompilacja własnego pakietu]] (przed kompilacją zmienić przypisane porty GPIO):

<code>https://github.com/hsm5xw/Linux-Device-Driver-for-Character-LCD-Kernel-Level</code>

Jako makefile użyć

<code>include $(TOPDIR)/rules.mk
include $(INCLUDE_DIR)/kernel.mk

PKG_NAME:=klcd
PKG_VERSION:=0.1
PKG_RELEASE:=1

PKG_BUILD_DIR:=$(BUILD_DIR)/$(PKG_NAME)-$(PKG_VERSION)

include $(INCLUDE_DIR)/package.mk

MAKEFLAGS_KMOD:= -C "$(LINUX_DIR)" \
                CROSS_COMPILE="$(TARGET_CROSS)" \
                ARCH="$(LINUX_KARCH)" \
                PATH="$(TARGET_PATH)" \
                SUBDIRS="$(PKG_BUILD_DIR)"

define KernelPackage/klcd
  SUBMENU:=RS
  DEPENDS:=
  TITLE:=Kernel level Linux Device Driver for a 16x2 character LCD
  FILES:=$(PKG_BUILD_DIR)/klcd.$(LINUX_KMOD_SUFFIX)
  VERSION:=$(LINUX_VERSION)+$(PKG_VERSION)-$(PKG_RELEASE)
  AUTOLOAD:=$(call AutoLoad,80,klcd)
endef 

define KernelPackage/klcd/description
        Kernel level Linux Device Driver for a 16x2 character LCD
endef


define Build/Prepare
        mkdir -p $(PKG_BUILD_DIR)
        $(CP) ./src/* $(PKG_BUILD_DIR)/
endef

define Build/Compile
        $(MAKE) $(MAKEFLAGS_KMOD) \
                modules
endef

$(eval $(call KernelPackage,klcd))</code>

Jako makefile znajdujący się bezpośrednio przy plikach:

<code>obj-m := klcd.o

ifeq ($(MAKING_MODULES),1)

-include $(TOPDIR)/Rules.make
endif</code>

<code>make menuconfig</code>

Wpis powinien pojawić się w "Kernel modules".

Skompilować

<code>make package/klcd/clean
make package/klcd/prepare
make package/klcd/compile
make package/klcd/install</code>

Oraz zainstalować

<code>opkg install [nazwa_pakietu]</code>
